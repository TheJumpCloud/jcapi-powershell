{
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "schemes": [
    "https"
  ],
  "swagger": "2.0",
  "info": {
    "description": "# API Overview\n\nThe purpose of this API is to query Jumpcloud Directory Insights events\n\n## Directory Insights\n\nDirectory Insights provides event logs, see activity happening in your directory, and monitor user authentications to the console, SSO apps, RADIUS, and LDAP. Directory Insights shines a light on audit trails leading up to critical events so you know the what, where, when, how, and who of your directory activities.\n\nDirectory Events:** Logs on activity in the Portal, including admin changes in the directory and admin/user authentications to the Portal.\nSAML Events:** Logs on user authentications to SAML applications.\nRADIUS Events:** Logs on user authentications to RADIUS used for wifi and VPNs.\nMacOS, Windows and Linux Events**: Logs about user authentications to systems including agent related events on lockout, password changes, and File Disk Encryption key updates.\nLDAP Events**: Logs about user authentications to LDAP, including LDAP bind and search events types.\nMDM Events**: Logs about MDM command results.\n\nHow to retrieve MSP Admin API Key\n\nLog into MTP portal.\nLaunch any one of the child organizations.\nClick on the icon for the logged in MTP Admin user account located on the upper right hand corner of the page.\nClick “API Settings”.\nCopy the API Key that appears in the popup dialog box. This is the MSP Admin API Key.\n\nDirectory Insights is available in our API, Powershell, and Activity Log. The API uses a single POST endpoint:\n\n```\nhttps://api.jumpcloud.com/insights/directory/v1/events\n```\n\n## Data Retention\n\nJumpCloud stores 90 days of event logs and removes logs older than the retention period. If you would like to store data for longer periods of time, our [AWS Serverless Application](https://support.jumpcloud.com/support/s/article/The-JumpCloud-Directory-Insights-AWS-Serverless-Application) automatically exports Directory Insights events to a customer's S3 for longer storage options.\n\n# Authentication & Authorization\n\n## Authentication\n\n### Access Your API Key\n\nTo locate your API Key:\n\n1. Log in to the [JumpCloud Admin Portal](https://console.jumpcloud.com/).\n2. Go to the username drop down located in the top-right of the Portal.\n3. Retrieve your API key from API Settings.\n\n### API Key Considerations\n\nThis API key is associated with the currently logged in administrator. Only administrator roles can access the API. Command runners will receive 403 error.\n\nPlease keep this API key secret, as it grants full access to any data accessible via your JumpCloud admin account.\n\nYou can also reset your API key in the same location in the JumpCloud Admin Portal.\n\n#### Recycling or Resetting Your API Key\n\nIn order to revoke access with the current API key, simply reset your API key. This will render all calls using the previous API key inaccessible.\n\n### Example Request (Mac and LINUX)\n\n```\ncurl -X POST -H x-api-key:[YOUR_API_KEY_HERE]\" -H \"Content-Type: application/json\" --data '{\"service\": [\"all\"], \"start_time\": \"2020-03-03T14:00:00Z\"}' https://api.jumpcloud.com/insights/directory/v1/events\n```\n\n### Example Request (Windows)\n\nFor Windows we recommend creating a local .txt file to pass in the JSON POST body with the query parameters.\n\n```\ncurl -X POST -H \"x-api-key:[YOUR_API_KEY_HERE]\" -H \"Content-Type: application/json\" --data @./filewithpostbody.txt \"https://api.jumpcloud.com/insights/directory/v1/events\"\n```\n\nIn the example above create a file `filewithpostbody.txt` with the POST body and execute the command within the directory with the local file. See [how to create a POST body](#json-post-request-body) below.\n\n```\n{\n\"service\": [\"all\"],\n\"start_time\": \"2020-03-03T00:00:00Z\"\n}\n```\n\n## Managed Service Providers\n\nManaged Service Providers can query client organizations and events generated within the Multi-Tenant Portal with an API key from an MSP admin and an organization id for the client org they administrator.\n\n### Example Request With One Organization\n\n```\ncurl -X POST -H \"x-api-key:[YOUR_API_KEY_HERE]\" -H \"x-org-id:[ADMINISTERED_ORG_ID]\" -H \"Content-Type: application/json\" --data '{\"service\": [\"all\"], \"start_time\": \"2020-03-03T14:00:00Z\"}' https://api.jumpcloud.com/insights/directory/v1/events\n```\n\n### Example Request With More Than One Organization\n\n```\ncurl -X POST -H \"x-api-key:[YOUR_API_KEY_HERE]\" -H \"x-org-id:[ADMINISTERED_ORG_ID_A]\" -H \"x-org-id:[ADMINISTERED_ORG_ID_B]\" -H \"x-org-id:[ADMINISTERED_ORG_ID_C]\" -H \"Content-Type: application/json\" --data '{\"service\": [\"all\"], \"start_time\": \"2020-03-03T14:00:00Z\"}' https://api.jumpcloud.com/insights/directory/v1/events\n```\n\n### Example To Request Multi-Tenant Portal Events Only\n\nThere is no limit to the number of org id's that can be passed in the request.\n\n```\ncurl -X POST -H \"x-api-key:[YOUR_API_KEY_HERE]\" -H \"Content-Type: application/json\" --data '{\"service\": [\"all\"], \"start_time\": \"2020-03-03T14:00:00Z\"}' https://api.jumpcloud.com/insights/directory/v1/events\n```\n\n# How to use the Directory Insights API\n\n## JSON POST request body\n\nQueries are made by HTTP POST request to the api’s /events web context, using curl or Postman or wget or other HTTP client.\n\nThe two required fields in the JSON body are\n\n```\n\"service\": [\"<service name>\"]\n```\n\nand\n\n```\n\"start_time\": \"<RFC 3339 date>\"\n```\n\nValid values for \"service\" are:\n\n<table>\n<tr>\n<td>\"all\"</td>\n<td>Logs from all services.</td>\n</tr>\n<tr>\n<td>\"directory\"</td>\n<td>Logs on activity in the Portal, including admin changes in the directory and admin/user authentications to the Portal.</td>\n</tr>\n<tr>\n<td>\"radius\"</td>\n<td>Logs on user authentications to RADIUS used for wifi and VPNs.</td>\n</tr>\n<tr>\n<td>\"sso\"</td>\n<td>Logs on user authentications to SAML applications.</td>\n</tr>\n<tr>\n<td>\"systems\"</td>\n<td>Logs about user authentications to MacOS, Windows, and Linux systems including agent related events on lockout, password changes, and File Disk Encryption key updates.</td>\n</tr>\n<tr>\n<td>\"ldap\"</td>\n<td>Logs about user authentications to LDAP, including LDAP bind and search events types.</td>\n</tr>\n<tr>\n<td>\"mdm\"</td>\n<td>Logs about MDM command results.</td>\n</tr>\n</table>\n\nIf you specify an invalid or unknown value for \"service\", the system will respond with the list of supported values.\n\nChoose a start time you’d like the service to start searching. Specify an RFC3339-formatted UTC date. For example, RFC3339 = \"2020-01-01T14:00:00Z\".\n\n(yyyy-mm-ddTHH:mm:ssZ (timezone optional, please reference RFC3339 or use Z as in the example). You’ll be informed about missing or invalid date formats, as well as start dates in the future and end dates before start dates.\n\nPutting the two required fields together, searching for radius events on or after Jan 1st 2020 2pm UTC -- your JSON HTTP body would be:\n\n### Example\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\"\n}\n```\n\nIf you would prefer to put the post body into a local file for easy edits, save the JSON structure into a file called simple-query.txt, and execute the query:\n\n```\ncurl -X POST -H \"x-api-key:[YOUR_API_KEY_HERE]\" -d @./simple-query.txt https://api.jumpcloud.com/insights/directory/v1/events\n```\n\nThe Directory Insights API returns a JSON array, such as the following:\n\n### Example Admin Login Attempt Response\n\n```\n{\n\"geoip\": {\n\"timezone\": \"America/Denver\",\n\"country_code2\": \"US\",\n\"continent_code\": \"NA\",\n\"region_name\": \"Colorado\",\n\"region_code\": \"CO\"\n},\n\"event_type\": \"admin_login_attempt\",\n\"resource\": {\n\"id\": \"5ce434e77128503e528e747c\",\n\"type\": \"admin\",\n\"email\": \"jane.doe@gmail.com\"\n},\n\"provider\": null,\n\"success\": true,\n\"organization\": \"5ce434e87128303e528e747b\",\n\"@version\": \"1\",\n\"mfa\": true,\n\"client_ip\": \"73.203.76.115\",\n\"id\": \"5e95d60b05e8907888c4e009\",\n\"user_agent\": {\n\"patch\": \"4044\",\n\"minor\": \"0\",\n\"major\": \"81\",\n\"os\": \"Mac OS X\",\n\"build\": \"\",\n\"os_minor\": \"15\",\n\"os_major\": \"10\",\n\"name\": \"Chrome\",\n\"os_name\": \"Mac OS X\",\n\"device\": \"Other\"\n},\n\"timestamp\": \"2020-04-14T15:26:03.218Z\"\n}\n```\n\n\nEvery response with an HTTP 200 status code will return an array of events (possibly an empty array). Each array element is a row describing an event. They include, at a minimum, the exact timestamp that the event occurred. Other fields are variable and can be queried. Example queries follow in this document.\n\n## Row size limit\n\nBy default, the system returns a maximum of 1000 rows. You can change the number of rows returned to you by adding a value for limit, in the JSON body you send to the service:\n\n### Example | Row Limit\n\n```\n{\n\"service\": [\"radius\"],\n\"limit\": 2000,\n\"start_time\": \"2020-01-01T14:00:00Z\"\n}\n```\n\nThe maximum rows you can request is 10,000, and any nonsensical values for limit will cause the system to return the default row count.\n\n## HTTP Response header metadata\n\nIn the HTTP Response headers, you’ll find information about your query, including the number of rows returned to you in the results array (\"result_count\"), the search order we used (based on event timestamp) and other fields (\"limit\")which will be discussed later in this document.\n\n<table>\n<tr>\n<td>HTTP Response Header Metadata</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>X-Result-Count</td>\n<td>is the number of elements in the array returned by the service.</td>\n</tr>\n<tr>\n<td>X-Limit</td>\n<td>the maximum number of rows the service can return in one call.</td>\n</tr>\n<tr>\n<td>X-Sort</td>\n<td>the sort direction of the result array timestamp column.</td>\n</tr>\n<tr>\n<td>X-Search_after</td>\n<td>the token you’ll send to the service to get subsequent pages of data. This is explained in the section below.</td>\n</tr>\n<tr>\n<td>X-Request-Id</td>\n<td>is a tracing header we can use to follow a specific query through the system</td>\n</tr>\n</table>\n\n### Example | Response Header\n\n```\nX-Result-Count:1000\nX-Limit:1000\nX-Sort:ASC\nX-Search_after:[ 1576181718000, \"DZrPyW8BNsa9iKWoOm7h\"]\nX-Request-Id:f5b277fc-7b0b-4c1e-9bee-c5ea1d79302f\n```\n\n## Getting all the pages of data\n\nIt is possible that more rows match your query than are initially returned by the service. To retrieve subsequent pages of data, you’ll simply specify the exact same query again, adding  specific information from the `X-Search_after` response header returned to you in your first query.\n\n### Example | Header\n\n```\nX-Result-Count:1000\nX-Limit:1000\nX-Sort:ASC\nX-Search_after:[ 1576181718000, \"DZrPyW8BNsa9iKWoOm7h\"]\nX-Request-Id:f5b277fc-7b0b-4c1e-9bee-c5ea1d79302f\n```\n\nFor example, if the system responds with 1000 events and the following HTTP response headers, you can see that the system returned 1000 rows to you (`X-Result-Count`) which equaled the limit of the number of rows the service could return (`X-Limit`). When this happens (result count == limit) you will need to send more requests to the service to get the remaining pages of matching results.\n\nTo get the next page of rows, simply re-issue the exact query you did the first time, but for this query, add the \"search_after\" section with the value from the `X-Search_after` header.\n\n### Example | Query for next page of results\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"search_after\": [ 1576181718000, \"DZrPyW8BNsa9iKWoOm7h\"]\n}\n```\n\nThe system will again respond, with the matching events from the second query, and a new set of HTTP response headers. To retrieve all of the events matching your query, you’ll need to continue comparing the `X-Limit` and `X-Result-Count` header values to see if there are still more pages. If so, re-issue the query again, but specify the new  \"search_after\" value. Once the `X-Result-Count` value is less than` X-Limit`, you have reached the last page of events data.\n\nPlease note that the `X-Search_after` response header value will continually change. That is, you will get a different `X-Search_after` value every time you specify a search. Don’t hold on to a `X-Search_after` value; always parse the specific response you get from the service, then add that value to the  \"search_after\" JSON property of your query to get the next page of events.\n\nYou will always need to do this procedure to get all the rows matching your query: Send a request, check the HTTP status code, then check to see if there are further rows, then execute more requests that match your first query but include each \"search_after\" value, until the response header ` X-Result-Count `is less than the page `X-Limit` size.\n\nNote:** The header always returns `X-Search_after` values, even when no further pages of data exist. You must compare `X-Result-Count` and `X-Limit` values to know if you’re at the last page of data.\n\n## Sort\n\nBy default, the system responds with events in ascending timestamp order. To override this behavior, add the following to the request body, typically above the \"search_term\" section:\n\n### Example | Sort\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"sort\":\"DESC\"\n}\n```\n\n\"sort\" is an optional field and is not required for a query. Nonsensical/missing sort directives cause the system to default to ascending order, silently. The \"sort\" directive is not case sensitive.\n\nThe sort order used by the system is included with the other HTTP response header metadata: `X-Sort:ASC`. If the system responds with a value that doesn’t match your requested value, it’s likely the system has defaulted back to an ASC sort on time.\n\n## Selecting only specific fields to return\n\nBy default, the system returns all available fields, for each object in the response array. Sometimes, for very large page sizes and result sets, returning less data can improve your download times.\n\nTo limit the fields that the system returns, list the fields in a \"fields\" array, and the system will return only those fields. \"fields\" is an optional field. If you specify an empty list, or a list containing no known fields, the system will respond with a 400 HTTP status.\n\n### Example | Fields\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"fields\": [\"timestamp\", \"username\", \"client_ip\", \"success\"]\n}\n```\n\nThe following query returns only the four mentioned fields, for each event result in the returned array of events.\n\n## End time\n\nLike \"start_time\",the system will optionally accept an \"end_time\" value to limit the amount of rows returned, to those between the two dates.\n\n### Example | End time\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"end_time\": \"2020-02-01T14:00:00Z\"\n}\n```\n\nThe following query returns rows between the two specified dates. The field \"end_time\" is not required, but if present, must be specified in the \"search_term\" section, and must come after the value you specify for the \"start_time\" field.\n\n## Search\n\nThe \"search_term\" section also allows you to query events based on more advanced criteria. You group these criteria with a logical operator of \"and\" and \"or\" and one or more search terms. To match events with all of a multiple set of criteria, use the \"and\" list of terms. If you wish to match events with _any of a multiple set of criteria_, use the \"or\" list of terms.\n\nValid search terms are any event field returned by the system in the JSON object (\"username\", \"client_ip\", \"success\", etc)\n\n### Example | AND\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"search_term\": {\n\"and\": [\n{ \"username\": \"root\"} ,\n{ \"client_ip\": \"1.2.3.4\" }\n]\n}\n}\n\n```\n\nThe following query returns events with both \"username\" of \"root\" and with \"client_ip\" of \"1.2.3.4\"\n\nYou can add one or more field criteria in the \"and\" list. You cannot repeat a field name in the\n\nlist. The system will return events _matching all of the criteria_ in the list.\n\nThere is no system-imposed limit on the number of criteria in the list, however extreme complex searches may result in a HTTP 500 error.\n\n### Example | OR\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"search_term\": {\n\"or\": [\n{ \"username\": \"root\"} ,\n{ \"client_ip\": \"1.2.3.4\"}\n]\n}\n}\n```\n\nThe proceeding query returns any events that have either a \"username\" of \"root\" or a \"client_ip\" of \"1.2.3.4\". To specify multiple values for the same field, enclose them in an array (brackets).\n\nNote:** Field values are coerced to lowercase on insert, please use lowercase values in your search_terms.\n\nSearch Queries Not Supported**\nA majority of the Directory Insights attributes are searchable except for `\"changes\"`, \"user_agent\", and \"system_timestamp\".\n\nNested Object Event Data**\nYou may have noticed that the Directory Insights API returns event data that includes objects in one structure. For example, consider the following event data returned by the API:\n\n```\n{\n\"error_message\": null,\n\"auth_type\": \"eap\",\n\"nas_mfa_state\": \"DISABLED\",\n\"eap_type\": \"MSCHAPv2\",\n\"outer\": {\n\"error_message\": null,\n\"eap_type\": \"PEAP\",\n\"username\": \"zezeye21\"\n},\n\"mfa\": false,\n\"mfa_meta\": {\n\"type\": \"none\"\n},\n\"success\": true,\n\"organization\": \"5dc058bc3f53f95e3972f03f\",\n\"client_ip\": \"209.235.170.66\",\n\"id\": \"ED0ED2C3-0524-3263-BE5B-68C02B70986E\",\n\"username\": \"zezeye21\",\n\"timestamp\": \"2019-12-12T20:15:15Z\"\n},\n```\n\nQueries (and field return lists) accept any of the top-level field names (such as `\"client_ip\"`and `\"username\"`), by default.\n\nIn the event above, you can see event data named \"outer\" that itself is a list of fields. To query one of these sub-fields, simply use a \"dot\" notation, specifying the parent (outer) field name, and the child field name. For example, specify the query:\n\n### Example | Nested searching\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"search_term\": {\n\"and\": [\n{\"outer.eap_type\": \"PEAP\"}\n]\n}\n}\n```\n\n...and the service will return only events with an `\"outer\"` field list containing an `\"eap_type\"` value of **`\"PEAP\"`**\nPlease note that you may use this parent-child dot notation anywhere event fields can be specified: and/or queries, and Field projection lists.\n\n## Advanced search: List values\n\nInstead of searching for a single value, you can also specify a list of values to search in the \"and\" and \"or\" criteria.\n\n### Example | AND\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"search_term\": {\n\"and\": [\n{    \"username\": [\"root\", \"admin\"]}\n]\n}\n}\n```\n\nThe following example returns any events that have a \"username\" of either \"root\" or  \"admin\".\n\n### Example | OR\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"search_term\": {\n\"or\": [\n{\"username\": [\"root\", \"admin\"]},\n{\"client_ip\": [\"1.2.3.4\", \"2.3.4.5\"]}\n]\n}\n}\n```\n\nThe following example returns all events that have EITHER:\n\n1. a \"username\" of \"root\" or \"admin\"\n2. or a \"client_ip\" of \"1.2.3.4\" or \"2.3.4.5\"\n\nChanging the query to \"and\" the system would match documents with BOTH those criteria.\n\nNote:** JSON does not allow a term to be repeated. For example, you cannot request different values for the same field as in the example below\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"search_term\": {\n\"or\": [\n{\"username\": \"root\"},\n{\"username\": \"admin\"}\n]\n}\n}\n```\n\n## Advanced search: Compound Logic\n\nThe \"search_term\" section allows complex queries using compound logic with \"and\" and \"or\" logical operators. All of the content of both \"and\" and \"or\" should be comma-separated JSON objects, enclosed in a JSON array []\n\n### Example | Search for failed authentications of paul where (initiated_by.username = paul OR username = paul) AND success = false\n\n```\n{\n\"service\": [\"radius\"],\n\"start_time\": \"2020-01-01T14:00:00Z\",\n\"search_term\": {\n\"and\": [\n{ \"success\": \"false\"},\n{\n\"or\": [\n{ \"initiated_by.username\": \"paul\" },\n{\"username\": \"paul\" }\n]\n}\n]\n}\n}\n```\n\n# Schemas\n\n## Directory Attributes\n\n<table>\n<tr>\n<td>Field</td>\n<td>Type</td>\n<td>Example</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>id</td>\n<td>uuid</td>\n<td>30b03bc3-be76-4919-b341-f9b271a5777e</td>\n<td>Unique id for the event</td>\n</tr>\n<tr>\n<td>event_type</td>\n<td>string</td>\n<td>systemuser_update</td>\n<td>Event type</td>\n</tr>\n<tr>\n<td>timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2019-03-04T18:08:26Z</td>\n<td>Timestamp of when the event occured (UTC)</td>\n</tr>\n<tr>\n<td>resource</td>\n<td>object</td>\n<td>{<p>\n\"type\": \"systemuser\",<p>\n\"id\": \"5c86b7149fdce00001d38014\",<p>\n\"username\": \"testexample\"<p>\n}</td>\n<td>Resource that was changed or attempted the login</td>\n</tr>\n<tr>\n<td>organization</td>\n<td>keyword</td>\n<td>5a2af2a82cf2b0010053ea41</td>\n<td>Organization that the user belongs to</td>\n</tr>\n<tr>\n<td>changes</td>\n<td>Nested objects</td>\n<td>[<p>\n{<p>\n\"field\": \"lastname\",<p>\n\"from\": \"0c7ee32b-345e-473e-a450-ebc7dddb0566\",<p>\n\"to\": \"48163dd3-e9cf-44d3-b48a-438a0177e308\"<p>\n}<p>\n]</td>\n<td>List of changes made in the request. You cannot search on the contents of this field.</td>\n</tr>\n<tr>\n<td>initiated_by</td>\n<td>object</td>\n<td>{<p>\n\"id\": \"5845d8f9c4894c85596c54f3\",<p>\n\"type\": \"admin\",<p>\n\"email\": \"user1@domain.com\"<p>\n\"source\": \"jumpcloud:scim\"<p>\n\"source_metadata\": {<p>\n\"name\": \"okta\",      }<p>\n}</td>\n<td>Object that describes who initiated the request.</td>\n</tr>\n<tr>\n<td>association</td>\n<td>object</td>\n<td>{<p>\n\"type\": \"admin\",<p>\n\"id\": \"5c86b6cf9fdce00001d3800c\",<p>\n\"email\": \"user1@domain.com\"<p>\n}</td>\n<td>Object that describes a change in association, such as adding a user to a group.</td>\n</tr>\n<tr>\n<td>client_ip</td>\n<td>string</td>\n<td>10.1.2.3</td>\n<td>IP address the request came from</td>\n</tr>\n<tr>\n<td>useragent</td>\n<td>object</td>\n<td>      \"useragent\": {<p>\n\"os\": \"Fedora\",<p>\n\"minor\": \"0\",<p>\n\"major\": \"71\",<p>\n\"build\": \"\",<p>\n\"name\": \"Firefox\",<p>\n\"os_name\": \"Fedora\",<p>\n\"device\": \"Other\"<p>\n</td>\n<td>User agent information for the browser that submitted the request. You cannot search on the contents of this field.</td>\n</tr>\n<tr>\n<td>auth_method</td>\n<td>string</td>\n<td>session</td>\n<td>Session = console, api-key = api-key</td>\n</tr>\n<tr>\n<td>success</td>\n<td>boolean</td>\n<td>true</td>\n<td>DeNotes if a login attempt was successful or not</td>\n</tr>\n<tr>\n<td>mfa</td>\n<td>boolean</td>\n<td>true</td>\n<td>DeNotes if mfa was used on an authentication attempt</td>\n</tr>\n<tr>\n<td>mfa_meta</td>\n<td>object</td>\n<td>{\"type\":\"duo\"}</td>\n<td>Object that contains meta data around mfa authentication such as the type of mfa.</td>\n</tr>\n<tr>\n<td>geoip</td>\n<td>object</td>\n<td>    \"geoip\": {<p>\n\"timezone\": \"America/Los_Angeles\",<p>\n\"continent_code\": \"NA\",<p>\n\"region_code\": \"OR\",<p>\n\"country_code\": \"US\",<p>\n\"region_name\": \"Oregon\"<p>\n}</td>\n<td>Geo IP information for the ip address that made the request</td>\n</tr>\n<tr>\n<td>provider</td>\n<td>string</td>\n<td>5c86b6cf9fdce00001d3800c</td>\n<td>The org id of the provider if the org is a provider org</td>\n</tr>\n<tr>\n<td>service</td>\n<td>string</td>\n<td>directory</td>\n<td>Which service the event originated from</td>\n</tr>\n<tr>\n<td>auth_context</td>\n<td>object\n<td>{<p>\n\"auth_methods\": {<p>\n\"totp\":  {  \"success\": true     },<p>\n\"webauthn\":  {  \"success\": false     },<p>\n\"duo\":  {  \"success\": false     },<p>\n\"password\":  {  \"success\": true     }<p>\n},\n<p>\n\"system\": {<p>\n\"hostname\": \"my-host\",<p>\n\"id\": \"5e90795a9de53959cf505121\",<p>\n\"displayName\": \"My Computer\",<p>\n\"os\": \"Microsoft Windows 10 Pro\",<p>\n\"version\": \"10.0.18362\"<p>\n},\n<p>\n\"policies_applied\": [{<p>\n\"name\": \"policyA\",<p>\n\"id\": \"5e90795a9de53959cf505111\",<p>\n},<p>\n{<p>\n\"name\": \"policyB\",<p>\n\"id\": \"5e90795a9de53959cf505112\",<p>\n}]\n<p>\n}</td>\n<td>Object for authentication context including factors used, device information if cert was present, and policies that were applied.</td>\n</tr>\n</table>\n\n\n## Software Attributes\n\n<table>\n<tr>\n<td><strong>Name</strong</td>\n<td><strong>Type</strong></td>\n<td><strong>Example</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>event_type</td>\n<td>string</td>\n<td>software_add, software_change, software_remove</td>\n<td>Type of software event.</td>\n</tr>\n<tr>\n<td>service</td>\n<td>string</td>\n<td>software</td>\n<td>Name of the feature that emits events</td>\n</tr>\n<tr>\n<td>Provider</td>\n<td>string</td>\n<td>5c8fcfe0e7eb500001c71062</td>\n<td>Unique ID for the provider</td>\n</tr>\n<tr>\n<td>org_id</td>\n<td>string</td>\n<td>5c8fcfe0e7eb500001c71062</td>\n<td>Unique ID for the organization</td>\n</tr>\n<tr>\n<td>system</td>\n<td>object</td>\n<td>{<br>\n\"systemId\": \"5c86b7149fdce00001d38014\",\n\"hostname\": \"my-host\",\n\"displayName\": \"My System\"<br>\n}</td>\n<td>Object that describes the system</td>\n</tr>\n<tr>\n<td>program</td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2019-03-04T18:08:26Z</td>\n<td>Timestamp of when the event occurred (UTC)</td>\n</tr>\n<tr>\n<td>resource</td>\n<td>object</td>\n<td>{<br>\n\"type\": \"unknown\",<br>\n}</td>\n<td>Object that describes the software resource</td>\n</tr>\n</table>\n\n## MTP/MSP Events\n\n<table>\n<tbody>\n<tr>\n<td>Field</td>\n<td>Type</td>\n<td>Example</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>service</td>\n<td>string</td>\n<td>directory</td>\n<td>The service the event originated from.</td>\n</tr>\n<tr>\n<td>event_type</td>\n<td>string</td>\n<td>admin_update</td>\n<td>\n<p>Examples of MTP events.</p>\n<ul>\n<li>admin_password_reset_request</li>\n<li>admin_login_attempt</li>\n<li>admin_lockout</li>\n<li>admin_update</li>\n<li>admin_create</li>\n<li>admin_activated</li>\n<li>admin_suspended</li>\n<li>admin_password_change</li>\n<li>organization_create</li>\n<li>organization_update</li>\n<li>provider_update</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>client_ip</td>\n<td>string</td>\n<td>34.214.221.231</td>\n<td>The IP address the request came from.</td>\n</tr>\n<tr>\n<td>resource</td>\n<td>object</td>\n<td>\n<p>{</p>\n<p>&nbsp;\"type\": \"admin\",</p>\n<p>&nbsp;\"id\": \"6154d26a4dea2b7ec773b133\",</p>\n<p>&nbsp;\"email\": \"mital.patel+stageadmin5@jumpcloud.com\"</p>\n<p>}</p>\n</td>\n<td>Resource that was changed.</td>\n</tr>\n<tr>\n<td>changes</td>\n<td>list</td>\n<td>\n<p>[</p>\n<p>&nbsp;{</p>\n<p>&nbsp;&nbsp;\"field\": \"lastname\",</p>\n<p>&nbsp;&nbsp;\"from\": \"\",</p>\n<p>&nbsp;&nbsp;\"to\": \"Edited\"</p>\n<p>&nbsp;}</p>\n<p>]</p>\n</td>\n<td>\nList of changes made from the old record to the new record. You\ncannot search on the contents of this field.\n</td>\n</tr>\n<tr>\n<td>timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2021-10-22T17:38:53.650Z</td>\n<td>Timestamp of when the event occured (UTC).</td>\n</tr>\n<tr>\n<td>provider</td>\n<td>string</td>\n<td>5e160715b7782848e073301e</td>\n<td>The Org id of the provider if the org is a provider.</td>\n</tr>\n<tr>\n<td>geoip</td>\n<td>object</td>\n<td>\n<p>\"geoip\": {</p>\n<p>&nbsp;\"timezone\": \"America/Los_Angeles\",</p>\n<p>&nbsp;\"continent_code\": \"NA\",</p>\n<p>&nbsp;\"region_code\": \"OR\",</p>\n<p>&nbsp;\"country_code\": \"US\",</p>\n<p>&nbsp;\"region_name\": \"Oregon\",</p>\n<p>&nbsp;\"latitude\": \"45.8491\",</p>\n<p>&nbsp;\"longitude\": \"-119.7143\"</p>\n<p>}</p>\n</td>\n<td>Geo IP information for the ip address that made the request.</td>\n</tr>\n<tr>\n<td>id</td>\n<td>string</td>\n<td>5c8fcfe0e7eb500001c71062</td>\n<td>Unique ID for the event.</td>\n</tr>\n<tr>\n<td>user_agent</td>\n<td>object</td>\n<td>\n\"user_agent\": {\n<p>&nbsp;\"patch\": \"4472\",</p>\n<p>&nbsp;\"os\": \"Mac OS X\",</p>\n<p>&nbsp;\"minor\": \"0\",</p>\n<p>&nbsp;\"major\": \"91\",</p>\n<p>&nbsp;\"build\": \"\",</p>\n<p>&nbsp;\"os_minor\": \"15\",</p>\n<p>&nbsp;\"os_major\": \"10\",</p>\n<p>&nbsp;\"name\": \"Chrome\",</p>\n<p>&nbsp;\"os_name\": \"Mac OS X\",</p>\n<p>&nbsp;\"device\": \"Other\"</p>\n<p>}</p>\n</td>\n<td>\nUser agent information for the browser that submitted the request.\nYou cannot search on the contents of this field.\n</td>\n</tr>\n<tr>\n<td>@version</td>\n<td>integer</td>\n<td>1</td>\n<td>The schema version for the document object.</td>\n</tr>\n<tr>\n<td>initiated_by</td>\n<td>object</td>\n<td>\n<p>{</p>\n<p>&nbsp;\"type\": \"admin\",</p>\n<p>&nbsp;\"id\": \"60dca2e6c6b18a68cc4093dc\",</p>\n<p>&nbsp;\"provider\": \"5e160715b7782848e073301e\",</p>\n<p>&nbsp;\"email\": \"mital.patel+stageadmin@jumpcloud.com\"</p>\n<p>}</p>\n</td>\n<td>Object that describes who initiated the request.</td>\n</tr>\n<tr>\n<td>auth_method</td>\n<td>string</td>\n<td>session</td>\n<td>Session equals console and api-key equals api-key.</td>\n</tr>\n<tr>\n<td>organization</td>\n<td>string</td>\n<td>5c86b6cf9fdce00001d3800b</td>\n<td>\nThe Org associated with the event if it is present on the user,\nsystem user or on the request. Otherwise, the value will be null.\n</td>\n</tr>\n<tr>\n<td>mfa</td>\n<td>boolean</td>\n<td>true</td>\n<td>\nTrue means that Multi-Factor Authentication(MFA) was used on an\nauthentication attempt and false means it wasn't.\n</td>\n</tr>\n</tbody>\n</table>\n\n## SSO Attributes\n\n<table>\n<tr>\n<td>Field</td>\n<td>Type</td>\n<td>Example</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>id</td>\n<td>uuid</td>\n<td>30b03bc3-be76-4919-b341-f9b271a5777e</td>\n<td>Unique id for the event</td>\n</tr>\n<tr>\n<td>event_type</td>\n<td>string</td>\n<td>sso_auth</td>\n<td>Event type, for sso we only have sso_auth at this time</td>\n</tr>\n<tr>\n<td>timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2019-03-04T18:08:26Z</td>\n<td>Timestamp of when the event occured (UTC)</td>\n</tr>\n<tr>\n<td>initiated_by</td>\n<td>object</td>\n<td>{<p>\n\"type\": \"systemuser\",<p>\n\"id\": \"5c86b7149fdce00001d38014\",<p>\n\"username\": \"testexample\"<p>\n}</td>\n<td>User who initiated the auth attempt.</td>\n</tr>\n<tr>\n<td>organization</td>\n<td>keyword</td>\n<td>5a2af2a82cf2b0010053ea41</td>\n<td>Organization that the user belongs to</td>\n</tr>\n<tr>\n<td>application</td>\n<td>object</td>\n<td>{<p>\n\"id\": \"5c86b7469fdce00001d38016\",<p>\n\"name\": \"zendesk\",<p>\n\"sso_url\": \"https://sso.jumpcloud.com/saml2/zendesk\"<p>\n}</td>\n<td>Information for the application that the sso_auth was initiated for</td>\n</tr>\n<tr>\n<td>client_ip</td>\n<td>string</td>\n<td>10.1.2.3</td>\n<td>IP address the request came from</td>\n</tr>\n<tr>\n<td>useragent</td>\n<td>object</td>\n<td>      \"useragent\": {<p>\n\"os\": \"Fedora\",<p>\n\"minor\": \"0\",<p>\n\"major\": \"71\",<p>\n\"build\": \"\",<p>\n\"name\": \"Firefox\",<p>\n\"os_name\": \"Fedora\",<p>\n\"device\": \"Other\"<p>\n</td>\n<td>User agent information for the browser that submitted the request</td>\n</tr>\n<tr>\n<td>geoip</td>\n<td>object</td>\n<td>    \"geoip\": {<p>\n\"timezone\": \"America/Los_Angeles\",<p>\n\"continent_code\": \"NA\",<p>\n\"region_code\": \"OR\",<p>\n\"country_code\": \"US\",<p>\n\"region_name\": \"Oregon\"<p>\n}</td>\n<td>Geo IP information for the ip address that made the request</td>\n</tr>\n<tr>\n<td>idp_initiated</td>\n<td>bool</td>\n<td>TRUE</td>\n<td>True if the request was initiated from the Identity Provider (JumpCloud). False if the auth was initiated from the service provider.</td>\n</tr>\n<tr>\n<td>service</td>\n<td>string</td>\n<td>sso</td>\n<td>Which service the event originated from</td>\n</tr>\n</table>\n\n## Radius Attributes\n\n<table>\n<tr>\n<td>Name</td>\n<td>Type</td>\n<td>Example</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>id</td>\n<td>string</td>\n<td>077ED0A8-1B5F-3EA3-8AAC-E3999451A46D</td>\n<td>Unique ID for the event</td>\n</tr>\n<tr>\n<td>nas_mfa_state</td>\n<td>string</td>\n<td>disabled|enabled|required|always</td>\n<td>Disabled: No MFA required<p>\nEnabled: MFA is required if the user is configured for MFA<p>\nRequired: MFA is required unless the user is excluded and not configured for MFA<p>\nAlways: MFA always required</td>\n</tr>\n<tr>\n<td>auth_type</td>\n<td>string</td>\n<td>pap</td>\n<td>Authentication Type</td>\n</tr>\n<tr>\n<td>eap_type</td>\n<td>string</td>\n<td>MSCHAPv2</td>\n<td>EAP Type</td>\n</tr>\n<tr>\n<td>client_ip</td>\n<td>string</td>\n<td>192.168.0.1</td>\n<td>IP address the request came from</td>\n</tr>\n<tr>\n<td>Geoip</td>\n<td>object</td>\n<td>\"geoip\": {<p>\n\"timezone\":   \"America/Los_Angeles\",<p>\n\"continent_code\": \"NA\",<p>\n\"region_code\": \"OR\",<p>\n\"country_code\": \"US\",<p>\n\"region_name\": \"Oregon\"<p>\n}</td>\n<td>Geo IP information for the ip address that made the request</td>\n</tr>\n<tr>\n<td>success</td>\n<td>boolean</td>\n<td>true|false</td>\n<td>Whether the authentication succeeded or not</td>\n</tr>\n<tr>\n<td>username</td>\n<td>string</td>\n<td>john.doe</td>\n<td>Username provided for the auth attempt</td>\n</tr>\n<tr>\n<td>organization</td>\n<td>string</td>\n<td>5530392c3e2ab2b60c000047</td>\n<td>Org associated with the username and NAS.</td>\n</tr>\n<tr>\n<td>timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2019-03-04T18:08:26Z</td>\n<td>Timestamp of when the event occured (UTC)</td>\n</tr>\n<tr>\n<td>error_message</td>\n<td>string</td>\n<td>\"pap: Crypt digest does not match \\\\\"known good\\\\\" digest\"</td>\n<td></td>\n</tr>\n<tr>\n<td>mfa</td>\n<td>boolean</td>\n<td>true|false</td>\n<td>Whether MFA was supplied</td>\n</tr>\n<tr>\n<td>mfa_meta</td>\n<td>string</td>\n<td>{\"type\":\"totp\"}</td>\n<td>Information on the type of mfa</td>\n</tr>\n<tr>\n<td>outer</td>\n<td>object</td>\n<td>  \"outer\": {<p>\n\"eap_type\": \"PEAP\",<p>\n\"error_message\": null,<p>\n\"username\": \"fguo\"<p>\n},</td>\n<td>Object for outer</td>\n</tr>\n<tr>\n<td>outer:eap_type</td>\n<td>string</td>\n<td>peap</td>\n<td>Outer eap type</td>\n</tr>\n<tr>\n<td>outer:username</td>\n<td>string</td>\n<td>steve</td>\n<td>Outer username</td>\n</tr>\n<tr>\n<td>outer:error_message</td>\n<td>string</td>\n<td>      \"eap_peap: The users session was previously rejected: returning reject (again.)\",<p>\n\"eap: Failed continuing EAP PEAP (25) session.  EAP sub-module failed\"</td>\n<td>Outer error message</td>\n</tr>\n<tr>\n<td>service</td>\n<td>string</td>\n<td>radius</td>\n<td>Which service the event originated from</td>\n</tr>\n<tr>\n<td>initiated_by</td>\n<td>object</td>\n<td>{<p>\n\"id\": \"5845d8f9c4894c85596c54f3\",<p>\n\"type\": \"admin\",<p>\n\"email\": \"user1@domain.com\"<p>\n}</td>\n<td>Object that describes who initiated the request.</td>\n</tr>\n</table>\n\n## System Attributes\n\n<table>\n<tr>\n<td>Name</td>\n<td>Type</td>\n<td>Example</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2019-03-04T18:08:26Z</td>\n<td>Timestamp of when the event occured (UTC)</td>\n</tr>\n<tr>\n<td>system_timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2019-04-09T05:01:18+09:30</td>\n<td>Local system time</td>\n</tr>\n<tr>\n<td>id</td>\n<td>string</td>\n<td>5c8fcfe0e7eb500001c71062</td>\n<td>Unique ID for the event</td>\n</tr>\n<tr>\n<td>event_type</td>\n<td>string</td>\n<td>user_login</td>\n<td>Event type</td>\n</tr>\n<tr>\n<td>organization</td>\n<td>string</td>\n<td>5c86b6cf9fdce00001d3800b</td>\n<td>Org associated with the event</td>\n</tr>\n<tr>\n<td>system</td>\n<td>object</td>\n<td><p>{</p><p>\"id\": \"5c86b7149fdce00001d38014\",</p><p>\"hostname\": \"my-host\",</p><p>\"displayName\": \"My System\"</p><p>}</p></td>\n<td>Object that describes the system</td>\n</tr>\n<tr>\n<td>message</td>\n<td>string</td>\n<td>User vagrant logged in from 10.0.2.2, process name: sshd</td>\n<td>Log message associated with a login attempt</td>\n</tr>\n<tr>\n<td>client_ip</td>\n<td>string</td>\n<td>10.1.2.3</td>\n<td>IP address the request came from</td>\n</tr>\n<tr>\n<td>src_ip</td>\n<td>string</td>\n<td>10.0.2.2</td>\n<td>IP address the login request came from</td>\n</tr>\n<tr>\n<td>username</td>\n<td>string</td>\n<td>vagrant</td>\n<td>Username provided for the auth attempt</td>\n</tr>\n<tr>\n<td>process_name</td>\n<td>string</td>\n<td>sshd</td>\n<td>Process that initiated a login attempt</td>\n</tr>\n<tr>\n<td>success</td>\n<td>bool</td>\n<td>TRUE</td>\n<td>Whether a system authentication succeeded</td>\n</tr>\n<tr>\n<td>provider</td>\n<td>string</td>\n<td>5c86b6cf9fdce00001d3800b</td>\n<td>The org id of the provider if the org is a provider</td>\n</tr>\n<tr>\n<td>resource</td>\n<td>object</td>\n<td>{<p>\"type\": \"systemuser\",</p><p>\"id\": \"5c86b7149fdce00001d38014\",</p><p>\"username\": \"testexample\"</p><p>}</p></td>\n<td>Object for the resource changed</td>\n</tr>\n<tr>\n<td>changes</td>\n<td>list</td>\n<td>[<p>{</p><p>\"field\": \"password\"</p><p>}</p><p>]</p></td>\n<td>List of changes made in the request. You cannot search on the contents of this field.</td>\n</tr>\n<tr>\n<td>initiated_by</td>\n<td>object</td>\n<td>{<p>\"type\": \"systemuser\",</p><p>\"id\": \"5c86b6cf9fdce00001d3800c\",</p><p>\"username\": \"testuser\"</p><p>}</p></td>\n<td>Object that describes who initiated the request.</td>\n</tr>\n<tr>\n<td>service</td>\n<td>string</td>\n<td>systems</td>\n<td>Which service the event originated from</td>\n</tr>\n<tr>\n<td>windows_meta</td>\n<td>object</td>\n<td>{<p>\"elevated\": true,\n</p><p>\"logon_type\": \"5\"</p><p>}</p></td>\n<td><p>Information about windows authentications including if the login had elevated privileges and the logon type.</p><p>Logon types:</p><br />2 Interactive,<br />3 Network,<br />4 Batch, <br />5 Service, <br />7 Unlock, <br />8 NetworkCleartext, <br />9 NewCredentials, <br />10 RemoteInteractive, <br />11 CachedInteractive</td>\n</tr>\n</table>\n\n## LDAP Attributes\n\n<table>\n<tr>\n<td>Name</td>\n<td>Type</td>\n<td>Example</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2019-03-04T18:08:26Z</td>\n<td>Timestamp of when the event occured (UTC)</td>\n</tr>\n<tr>\n<td>connection_id</td>\n<td>string</td>\n<td>UhKgFeYIvbsh4so/f8z7xUnH0rDLk5Ph1n6XQnT08ds=</td>\n<td>Unique id for every LDAP connection.</td>\n</tr>\n<tr>\n<td>operation_number</td>\n<td>integer</td>\n<td>0</td>\n<td>All operation requests and operation result pairs are given incremental operation numbers beginning with operation_number=0 to identify the distinct operations being performed.</td>\n</tr>\n<tr>\n<td>event_type</td>\n<td>string</td>\n<td>ldap_bind</td>\n<td>The type of LDAP event: bind or search.</td>\n</tr>\n<tr>\n<td>dn</td>\n<td>string</td>\n<td>uid=adminR,ou=Users,o=57600aea6b8a769c6cef11ed,dc=jumpcloud,dc=com</td>\n<td>Distinguished name (DN) provided for authentication. In this example we are authing user adminR in org 57600aea6b8a769c6cef11ed</td>\n</tr>\n<tr>\n<td>auth_method</td>\n<td>string</td>\n<td>simple, sasl, or anonymous</td>\n<td>Authentication method, 128 = simple, 163 = sasl, 0 = anonymous</td>\n</tr>\n<tr>\n<td>mech</td>\n<td>string</td>\n<td>simple</td>\n<td>The authentication method used. Either simple or SASL (we don't support SASL yet)</td>\n</tr>\n<tr>\n<td>start_tls</td>\n<td>boolean</td>\n<td>false</td>\n<td>The starttls protocol was used to open the LDAP connection.</td>\n</tr>\n<tr>\n<td>tls_established</td>\n<td>boolean</td>\n<td>false</td>\n<td>The LDAPS protocol was used to open the LDAP connection.</td>\n</tr>\n<tr>\n<td>username</td>\n<td>string</td>\n<td>john.doe</td>\n<td>Username provided for the auth attempt</td>\n</tr>\n<tr>\n<td>organization</td>\n<td>string</td>\n<td>5530392c3e2ab2b60c000047</td>\n<td>Org associated with the username and NAS.</td>\n</tr>\n<tr>\n<td>success</td>\n<td>boolean</td>\n<td>true|false</td>\n<td>Whether the authentication succeeded or not</td>\n</tr>\n<tr>\n<td>error_code</td>\n<td>integer</td>\n<td>10</td>\n<td>Result code</td>\n</tr>\n<tr>\n<td>error_message</td>\n<td>string</td>\n<td>invalid DN</td>\n<td>Optional error message</td>\n</tr>\n<tr>\n<td>oid</td>\n<td>string</td>\n<td>1.3.6.1.4.1.1466.20037</td>\n<td>LDAP object identifier.</td>\n</tr>\n<tr>\n<td>base</td>\n<td>string</td>\n<td>ou=Users,o=55ddd95d90426433661ae1e0,dc=jumpcloud,dc=com</td>\n<td>The base of the subtree in which the search is to be constrained.</td>\n</tr>\n<tr>\n<td>scope</td>\n<td>integer</td>\n<td>2</td>\n<td>The search scope. This specifies the portion of the target subtree that should be considered. Can be: base, only return the specified entry. singleLevel (1) only the immediate children of the entry are considered.</td>\n</tr>\n<tr>\n<td>deref</td>\n<td>integer</td>\n<td>0</td>\n<td>The alias dereferencing behavior, which indicates how the server should treat any aliases encountered while processing the search.</td>\n</tr>\n<tr>\n<td>filter</td>\n<td>string</td>\n<td>(&(objectClass=sambaDomain)(sambaDomainName=workgroup))</td>\n<td>The filter criteria for the search with the scope.</td>\n</tr>\n<tr>\n<td>attr</td>\n<td>string</td>\n<td>sambaDomainName sambaNextRid</td>\n<td>A set of attributes to be returned to the client.</td>\n</tr>\n<tr>\n<td>number_of_results</td>\n<td>integer</td>\n<td>1</td>\n<td>Number of rows returned from the srch</td>\n</tr>\n<tr>\n<td>service</td>\n<td>string</td>\n<td>ldap</td>\n<td>Which service the event originated from</td>\n</tr>\n<tr>\n<td>initiated_by</td>\n<td>object</td>\n<td>{<p>\n\"id\": \"5845d8f9c4894c85596c54f3\",<p>\n\"type\": \"admin\",<p>\n\"email\": \"user1@domain.com\"<p>\n}</td>\n<td>Object that describes who initiated the request.</td>\n</tr>\n</table>\n\n## MDM Attributes\n\n<table>\n<tr>\n<td>Name</td>\n<td>Type</td>\n<td>Example</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>id</td>\n<td>string</td>\n<td>5c8fcfe0e7eb500001c71062</td>\n<td>Unique ID for the event.</td>\n</tr>\n<tr>\n<td>timestamp</td>\n<td>RFC3339 Timestamp</td>\n<td>2019-03-04T18:08:26Z</td>\n<td>Timestamp of when the event occured (UTC)</td>\n</tr>\n<tr>\n<td>organization</td>\n<td>string</td>\n<td>5c86b6cf9fdce00001d3800b</td>\n<td>Org associated with the event.</td>\n</tr>\n<tr>\n<td> event_type</td>\n<td>string</td>\n<td>mdm_command_result</td>\n<td>The type of MDM event.</td>\n</tr>\n<tr>\n<td>mdm_type</td>\n<td>string</td>\n<td>apple</td>\n<td>The type of MDM service.</td>\n</tr>\n<tr>\n<td>device_object_id</td>\n<td>string</td>\n<td>5ebeb092658f7304f48e2d84</td>\n<td>Unique ID for the device.</td>\n</tr>\n<tr>\n<td>device_manager_object_id</td>\n<td>string</td>\n<td>5e95d0a128b4f8666ef26b87</td>\n<td>Unique ID for the device manager.</td>\n</tr>\n<tr>\n<td>command_uuid</td>\n<td>string</td>\n<td>a0325748-b432-42f6-b789-50b3924d64a4</td>\n<td>Unique ID for the command.</td>\n</tr>\n<tr>\n<td>request_type</td>\n<td>string</td>\n<td>RestartDevice</td>\n<td>The type of command.</td>\n</tr>\n<tr>\n<td>command</td>\n<td>object</td>\n<td>{<p>\n\"request_type\": \"RestartDevice\"<p>\n}</td>\n<td>The executed command.</td>\n</tr>\n<tr>\n<td>status</td>\n<td>string</td>\n<td>Acknowledged</td>\n<td>The command result: Acknowledged, Error, CommandFormatError, and Idle</td>\n</tr>\n<tr>\n<td>error_chain</td>\n<td>object</td>\n<td>[<p>\n{<p>\n\"error_code\": INT<p>\n\"error_domain\": STRING<p>\n\"localized_description\": STRING<p>\n\"us_english_description\": STRING<p>\n}<p>\n]</td>\n<td>Raw error details as reported by the MDM device.</td>\n</tr>\n<tr>\n<td>@version</td>\n<td>integer</td>\n<td>1</td>\n<td>The schema version for the document object.</td>\n</tr>\n<tr>\n<td>service</td>\n<td>string</td>\n<td>mdm</td>\n<td>Which service the event originated from</td>\n</tr>\n</table>\n\n# Event Types\n\n## Directory - Object Events\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>application_create</td>\n<td>SAML application is created.</td>\n</tr>\n<tr>\n<td>application_delete</td>\n<td>SAML application is deleted.</td>\n</tr>\n<tr>\n<td>application_update</td>\n<td>SAML application is modified.</td>\n</tr>\n<tr>\n<td>association_change</td>\n<td>Resource bound/unbound to a group.</td>\n</tr>\n<tr>\n<td>translation_rule_create</td>\n<td>Attribute mapping is created.</td>\n</tr>\n<tr>\n<td>translation_rule_delete</td>\n<td>Attribute mapping is deleted.</td>\n</tr>\n<tr>\n<td>group_create</td>\n<td>Group is created.</td>\n</tr>\n<tr>\n<td>group_delete</td>\n<td>Group is deleted.</td>\n</tr>\n<tr>\n<td>group_update</td>\n<td>Group is modified.</td>\n</tr>\n<tr>\n<td>notification_delete</td>\n<td>Notification is closed.</td>\n</tr>\n<tr>\n<td>organization_create</td>\n<td>Organization is created.</td>\n</tr>\n<tr>\n<td>organization_update</td>\n<td>An organization is updated.</td>\n</tr>\n<tr>\n<td>system_create</td>\n<td>System is created.</td>\n</tr>\n<tr>\n<td>system_delete</td>\n<td>System is deleted.</td>\n</tr>\n<tr>\n<td>system_update</td>\n<td>System is updated.</td>\n</tr>\n<tr>\n<td>radiusserver_create</td>\n<td>RADIUS server is created.</td>\n</tr>\n<tr>\n<td>radiusserver_delete</td>\n<td>RADIUS server is deleted.</td>\n</tr>\n<tr>\n<td>radiusserver_update</td>\n<td>RADIUS server is updated.</td>\n</tr>\n</table>\n\n## Directory - User and Admin Events\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>admin_create</td>\n<td>Admin is created.</td>\n</tr>\n<tr>\n<td>admin_delete</td>\n<td>Admin is deleted.</td>\n</tr>\n<tr>\n<td>admin_login_attempt</td>\n<td>Admin logs in success / failure.</td>\n</tr>\n<tr>\n<td>admin_password_reset_request</td>\n<td>Admin requests to resets their password</td>\n</tr>\n<tr>\n<td>admin_update</td>\n<td>An admin account is updated.</td>\n</tr>\n<tr>\n<td>user_create</td>\n<td>A user account is created.</td>\n</tr>\n<tr>\n<td>user_delete</td>\n<td>A user account is deleted.</td>\n</tr>\n<tr>\n<td>user_lockout</td>\n<td>A user account is locked out.</td>\n</tr>\n<tr>\n<td>user_login_attempt</td>\n<td>A user attempted to authenticate to user portal.</td>\n</tr>\n<tr>\n<td>user_mfa_exclusion_expired</td>\n<td>User's MFA enrollment expires.</td>\n</tr>\n<tr>\n<td>user_password_expired</td>\n<td>User's password expires.</td>\n</tr>\n<tr>\n<td>user_password_reset_request</td>\n<td>User requests to change their password.</td>\n</tr>\n<tr>\n<td>user_password_warning_email</td>\n<td>Password warning email is sent to user.</td>\n</tr>\n<tr>\n<td>user_update</td>\n<td>A user account is updated.</td>\n</tr>\n<tr>\n<td>user_password_change</td>\n<td>A user's password changed.</td>\n</tr>\n<tr>\n<td>user_activated</td>\n<td>A user account is activated.</td>\n</tr>\n<tr>\n<td>user_password_set</td>\n<td>A user account moves out of pending status.</td>\n</tr>\n<tr>\n<td>user_unlocked</td>\n<td>A user account is unlocked.</td>\n</tr>\n<tr>\n<td>user_suspended</td>\n<td>A user account is suspended.</td>\n</tr>\n<tr>\n<td>user_unsuspended</td>\n<td>A user account is unsuspended.</td>\n</tr>\n<tr>\n<td>user_suspension_schedule_create</td>\n<td>A scheduled job to suspend a user account is created.</td>\n</tr>\n<tr>\n<tr>\n<td>user_suspension_schedule_delete</td>\n<td>A scheduled job to suspend a user account is deleted.</td>\n</tr>\n<td>admin_password_change</td>\n<td>An admin's password changed.</td>\n</tr>\n<tr>\n<td>user_create_provision</td>\n<td>User created in external application</td>\n</tr>\n<tr>\n<td>user_update_provision</td>\n<td>User updated in external application</td>\n</tr>\n<tr>\n<td>user_delete_provision</td>\n<td>User deleted in external application</td>\n</tr>\n<tr>\n<td>user_admin_granted</td>\n<td>Admin granted user admin sudo privileges on device(s)</td>\n</tr>\n<tr>\n<td>user_admin_revoked</td>\n<td>Admin revoked user admin sudo privileges on device(s)</td>\n</tr>\n</table>\n\n## Directory - Command and Policy Events\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>command_create</td>\n<td>Command is created.</td>\n</tr>\n<tr>\n<td>command_delete</td>\n<td>Command is deleted.</td>\n</tr>\n<tr>\n<td>command_run</td>\n<td>Command runs.</td>\n</tr>\n<tr>\n<td>command_update</td>\n<td>Command is modified.</td>\n</tr>\n<tr>\n<td>commandresult_delete</td>\n<td>Command result is deleted.</td>\n</tr>\n<tr>\n<td>file_create</td>\n<td>File is uploaded in a command.</td>\n</tr>\n<tr>\n<td>file_delete</td>\n<td>File is deleted in a command.</td>\n</tr>\n<tr>\n<td>file_update</td>\n<td>File is changed in a command.</td>\n</tr>\n<tr>\n<td>policy_create</td>\n<td>Policy is created.</td>\n</tr>\n<tr>\n<td>policy_delete</td>\n<td>Policy is deleted.</td>\n</tr>\n<tr>\n<td>policy_update</td>\n<td>Policy is modified.</td>\n</tr>\n<tr>\n<td>authnpolicy_create</td>\n<td>Conditional access policy created.</td>\n</tr>\n<tr>\n<td>authnpolicy_delete</td>\n<td>Conditional access policy deleted.</td>\n</tr>\n<tr>\n<td>authpolicy_update</td>\n<td>Conditional access policy updated.</td>\n</tr>\n<tr>\n<td>iplist_create</td>\n<td>IP address list created</td>\n</tr>\n<tr>\n<td>iplist_delete</td>\n<td>IP address list deleted</td>\n</tr>\n<tr>\n<td>iplist_update</td>\n<td>IP address list updated</td>\n</tr>\n</table>\n\n## Directory - Integrations\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>activedirectory_create</td>\n<td>Active Directory instance created.</td>\n</tr>\n<tr>\n<td>activedirectory_delete</td>\n<td>Active Directory instance deleted.</td>\n</tr>\n<tr>\n<td>idsource_create</td>\n<td>AD Bridge V1 created.</td>\n</tr>\n<tr>\n<td>idsource_delete</td>\n<td>AD Bridge v1 deleted.</td>\n</tr>\n<tr>\n<td>idsource_update</td>\n<td>AD Bridge V1 updated.</td>\n</tr>\n<tr>\n<td>sambadomain_create</td>\n<td>Enabling Samba for LDAP directory.</td>\n</tr>\n<tr>\n<td>sambadomain_delete</td>\n<td>Disabling/removing Samba for LDAP directory.</td>\n</tr>\n<tr>\n<td>sambadomain_update</td>\n<td>Updating Samba configuration.</td>\n</tr>\n<tr>\n<td>workday_create</td>\n<td>Workday directory created.</td>\n</tr>\n<tr>\n<td>workday_delete</td>\n<td>Workday directory deleted.</td>\n</tr>\n<tr>\n<td>workday_update</td>\n<td>Workday directory updated.</td>\n</tr></tr>\n<tr> <td>integration_activate</td>\n<td>SCIM integration activated</td>\n</tr></tr>\n<tr> <td>integration_deactivate</td>\n<td>SCIM integration deactivated</td>\n</tr>\n<tr> <td>gsuite_directory_create</td>\n<td>Gsuite directory created.</td>\n</tr>\n<tr> <td>gsuite_directory_update</td>\n<td>Gsuite directory updated.</td>\n</tr>\n<tr> <td>gsuite_directory_delete</td>\n<td>Gsuite directory deleted.</td>\n</tr>\n<tr> <td>o365_directory_create</td>\n<td>O365 directory created.</td>\n</tr>\n<tr> <td>o365_directory_update</td>\n<td>O365 directory updated.</td>\n</tr>\n<tr> <td>o365_directory_delete</td>\n<td>O365 directory deleted.</td>\n</tr>\n</table>\n\n## Directory - MTP/MSP Events\n\n<h1>MTP Events Overview</h1>\n<p>\nMTP (multi-tenant portal) tracks administrator actions as events within\nthe MTP portal and allows MTPs to search for events across their managed\norganizations. Reports can be created that help you understand how your\nadminisrators access and use the multi-tenant portal, and to view all\nevents across MTP client organizations centrally. Use the Directory\nInsights API to analyze the event data in these reports and to create\ncustom solutions tailored to your organization’s specific needs.\n</p>\n<p>\nThe availability of the events data is governed by the JumpCloud data\nretention policies. For more information, see data retention policies.\n</p>\n<h2>What are the MTP activity events?</h2>\n<p>MTP provides the following types of events:</p>\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>admin_activated</td>\n<td>Created when admin unsuspends an admin.</td>\n</tr>\n<tr>\n<td>admin_create</td>\n<td>Created when admin creates an admin.</td>\n</tr>\n<tr>\n<td>admin_delete</td>\n<td>Created when admin deletes a user or bulk deletes users.</td>\n</tr>\n<tr>\n<td>admin_lockout</td>\n<td>\nCreated when an admin has multiple login failures into MTP portal.\n</td>\n</tr>\n<tr>\n<td>admin_login_attempt</td>\n<td>\nCreated when an admin logs into the MTP portal or admin launches an\nchild org.\n</td>\n</tr>\n<tr>\n<td>admin_password_reset_request</td>\n<td>Created when an admin resets their password.</td>\n</tr>\n<tr>\n<td>admin_suspended</td>\n<td>Created when admin suspends an admin.</td>\n</tr>\n<tr>\n<td>admin_update</td>\n<td>\nCreated when admin enables/disables TOTP, changes contact info, role\nfor an admin or admin updates an admin.\n</td>\n</tr>\n<tr>\n<td>organization_create</td>\n<td>Created when an admin creates an organization.</td>\n</tr>\n<tr>\n<td>organization_update</td>\n<td>Created when admin updates org name.</td>\n</tr>\n<tr>\n<td>provider_update</td>\n<td>Created when admin changes billing info.</td>\n</tr>\n</table>\n\n## RADIUS Events\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>radius_auth</td>\n<td>User authenticates to radius.</td>\n</tr>\n</table>\n\n## SSO Events\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>sso_auth</td>\n<td>User authenticates to an SSO application.</td>\n</tr>\n</table>\n\n## System Events\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>login_attempt</td>\n<td>User authenticates to a system.</td>\n</tr>\n<tr>\n<td>system_fde_key_update</td>\n<td>A system's file disk encryption key updates.</td>\n</tr>\n<tr>\n<td>user_password_change</td>\n<td>User password changes on a system.</td>\n</tr>\n<tr>\n<td>user_lockout</td>\n<td>User is locked out of a system.</td>\n</tr>\n<tr>\n<td>system_fde_key_decrypt</td>\n<td>A device’s file disk encryption key was decrypted.</td>\n</tr>\n</table>\n\n## LDAP Events\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>ldap_bind</td>\n<td>User authenticates to an LDAP directory server.</td>\n</tr>\n<tr>\n<td>ldap_search</td>\n<td>LDAP search operation performed.</td>\n</tr>\n</table>\n\n## MDM Events\n\n<table>\n<tr>\n<td><strong>Event</strong></td>\n<td><strong>Description</strong></td>\n</tr>\n<tr>\n<td>mdm_command_result</td>\n<td>MDM command result.</td>\n</tr>\n</table>",
    "title": "Directory Insights API",
    "contact": {
      "email": "support@jumpcloud.com"
    },
    "version": "1.0",
    "x-releaseTag": "v0.117.0"
  },
  "host": "api.jumpcloud.com",
  "basePath": "/insights/directory/v1",
  "paths": {
    "/events": {
      "post": {
        "security": [
          {
            "x-api-key": [],
            "x-org-id": []
          }
        ],
        "description": "Query the API for Directory Insights events\n#### Sample Request\n```\ncurl -X POST 'https://api.jumpcloud.com/insights/directory/v1/events' -H 'Content-Type: application/json' -H 'x-api-key: {API_KEY}' --data '{\"service\": [\"all\"], \"start_time\": \"2021-07-14T23:00:00Z\", \"end_time\": \"2021-07-28T14:00:00Z\", \"sort\": \"DESC\", \"fields\": [\"timestamp\", \"event_type\", \"initiated_by\", \"success\", \"client_ip\", \"provider\", \"organization\"]}'\n```",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "summary": "Query Events",
        "operationId": "Event_Get",
        "parameters": [
          {
            "description": "JSON event query body",
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/EventQuery"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Array of Directory Insights events JSON objects",
            "schema": {
              "type": "array",
              "items": {
                "type": "object",
                "additionalProperties": true
              }
            }
          }
        }
      }
    },
    "/events/count": {
      "post": {
        "security": [
          {
            "x-api-key": [],
            "x-org-id": []
          }
        ],
        "description": "Query the API for a count of matching events\n#### Sample Request\n```\ncurl -X POST 'https://api.jumpcloud.com/insights/directory/v1/events/count' -H 'Content-Type: application/json' -H 'x-api-key: {API_KEY}' --data '{\"service\": [\"all\"], \"start_time\": \"2021-07-14T23:00:00Z\", \"end_time\": \"2021-07-28T14:00:00Z\", \"sort\": \"DESC\", \"fields\": [\"timestamp\", \"event_type\", \"initiated_by\", \"success\", \"client_ip\", \"provider\", \"organization\"]}'\n```",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "summary": "Count Events",
        "operationId": "EventCount_Get",
        "parameters": [
          {
            "description": "JSON event query body",
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/EventQuery"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Count of matching event rows",
            "schema": {
              "$ref": "#/definitions/EventCount"
            }
          }
        }
      }
    },
    "/events/distinct": {
      "post": {
        "security": [
          {
            "x-api-key": [],
            "x-org-id": []
          }
        ],
        "description": "Query the API for a list of distinct values for a field\n#### Sample Request\n```\ncurl -X POST 'https://api.jumpcloud.com/insights/directory/v1/events/distinct' -H 'Content-Type: application/json' -H 'x-api-key: {API_KEY}' --data '{\"service\": [\"all\"], \"start_time\": \"2021-07-14T23:00:00Z\", \"end_time\": \"2021-07-28T14:00:00Z\", \"sort\": \"DESC\", \"field\": \"event_type\"}'\n```",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "summary": "Query event distinct field values",
        "operationId": "EventDistinct_Get",
        "parameters": [
          {
            "description": "JSON event distinct query body",
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/EventDistinctQuery"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of distinct field values",
            "schema": {
              "$ref": "#/definitions/EventCount"
            }
          }
        }
      }
    },
    "/events/interval": {
      "post": {
        "security": [
          {
            "x-api-key": [],
            "x-org-id": []
          }
        ],
        "description": "Query the API for a list of counts by time interval\n#### Sample Request\n```\ncurl -X POST 'https://api.jumpcloud.com/insights/directory/v1/events/interval' -H 'Content-Type: application/json' -H 'x-api-key: {API_KEY}' --data '{\"service\": [\"all\"], \"start_time\": \"2021-07-14T23:00:00Z\", \"end_time\": \"2021-07-28T14:00:00Z\", \"timezone\": \"-0500\", \"interval_unit\": \"h\", \"interval_value\": \"2\"}'\n```",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "summary": "Query event counts by bucketed by a time interval",
        "operationId": "EventInterval_Get",
        "parameters": [
          {
            "description": "JSON event interval query body",
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/EventIntervalQuery"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of bucketed event counts",
            "schema": {
              "type": "object",
              "properties": {
                "buckets": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "doc_count": {
                        "type": "integer"
                      },
                      "key": {
                        "type": "integer"
                      },
                      "key_as_string": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "definitions": {
    "EventCount": {
      "description": "EventCount JSON struct with count of matching events",
      "type": "object",
      "properties": {
        "count": {
          "type": "integer",
          "format": "int64",
          "x-go-name": "Count"
        }
      }
    },
    "EventDistinctQuery": {
      "description": "EventDistinctQuery is the users' command to search our auth logs for distinct values of the specified field",
      "allOf": [
        {
          "$ref": "#/definitions/EventServiceTimeQuery"
        },
        {
          "type": "object",
          "required": [
            "field"
          ],
          "properties": {
            "field": {
              "description": "field is what they wish to query on",
              "type": "string",
              "x-go-name": "Field"
            },
            "search_term": {
              "$ref": "#/definitions/SearchTerm"
            }
          }
        }
      ]
    },
    "EventIntervalQuery": {
      "description": "EventIntervalQuery is the users' command to search our auth logs for bucketed counts of values of the specified field",
      "allOf": [
        {
          "$ref": "#/definitions/EventServiceTimeQuery"
        },
        {
          "type": "object",
          "required": [
            "interval_unit"
          ],
          "properties": {
            "interval_unit": {
              "type": "string",
              "enum": [
                "s",
                "m",
                "h",
                "d",
                "w"
              ],
              "x-go-name": "IntervalUnit"
            },
            "interval_value": {
              "description": "Interval Value. This specifies how many units you want to bucket the event counts by",
              "type": "string",
              "x-go-name": "IntervalValue"
            },
            "search_term": {
              "$ref": "#/definitions/SearchTerm"
            },
            "timezone": {
              "description": "TimeZone. Specify the timezone in which the user is in\noptional",
              "type": "string",
              "x-go-name": "TimeZone"
            }
          }
        }
      ]
    },
    "EventQuery": {
      "description": "EventQuery is the users' command to search our auth logs",
      "allOf": [
        {
          "$ref": "#/definitions/EventServiceTimeQuery"
        },
        {
          "type": "object",
          "properties": {
            "fields": {
              "description": "optional list of fields to return from query",
              "type": "array",
              "items": {
                "type": "string"
              },
              "x-go-name": "Projection"
            },
            "limit": {
              "description": "Max number of rows to return",
              "type": "integer",
              "format": "int64",
              "x-go-name": "Limit"
            },
            "search_after": {
              "description": "Specific query to search after, see x-* response headers for next values",
              "type": "array",
              "items": {
                "type": "string"
              },
              "x-go-name": "SearchAfter"
            },
            "search_term": {
              "$ref": "#/definitions/SearchTerm"
            },
            "sort": {
              "description": "ASC or DESC order for timestamp",
              "type": "string",
              "x-go-name": "Sort"
            }
          }
        }
      ]
    },
    "EventServiceTimeQuery": {
      "description": "EventServiceTimeQuery is the base struct for most event queries\nit includes the minimum-required fields of service and start/end times",
      "type": "object",
      "required": [
        "service",
        "start_time"
      ],
      "properties": {
        "end_time": {
          "description": "optional query end time, UTC in RFC3339 format",
          "type": "string",
          "format": "date-time",
          "x-go-name": "EndTime"
        },
        "service": {
          "description": "service name to query.",
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "all",
              "systems",
              "radius",
              "sso",
              "directory",
              "ldap",
              "mdm"
            ]
          },
          "x-go-name": "Service"
        },
        "start_time": {
          "description": "query start time, UTC in RFC3339 format",
          "type": "string",
          "format": "date-time",
          "x-go-name": "StartTime"
        }
      }
    },
    "SearchTerm": {
      "description": "SearchTerm is the filter portion of the query\nit contains only one of 'and' or 'or' conjunction maps",
      "type": "object",
      "properties": {
        "and": {
          "$ref": "#/definitions/TermConjunction"
        },
        "or": {
          "$ref": "#/definitions/TermConjunction"
        }
      }
    },
    "TermConjunction": {
      "description": "TermConjunction represents a conjunction (and/or)\nNOTE: the validator limits what the operator can be, not the object\nfor future-proof-ness\nand a list of sub-values",
      "type": "object",
      "additionalProperties": true
    }
  },
  "securityDefinitions": {
    "x-api-key": {
      "type": "apiKey",
      "name": "x-api-key",
      "in": "header"
    },
    "x-org-id": {
      "type": "apiKey",
      "name": "x-org-id",
      "in": "header"
    }
  }
}
