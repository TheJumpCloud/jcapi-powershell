$ApiHash = [Ordered]@{
    'Url_V1' = 'https://api.stoplight.io/v1/versions/sNtcAibbBX7Nizrmd/export/oas.json';
    'Url_V2' = 'https://api.stoplight.io/v1/versions/JWvycPWBDeEZ3R5dF/export/oas.json';
}
$UpdatedSpec = $false
$OutputFilePath = $PSScriptRoot + '/SwaggerSpecs/'
# Build Find and Replace table
$FindReplaceHash = [Ordered]@{
    # Path Issues
    '"#/definitions/system"'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = '"#/definitions/JcSystem"'; # The "system" class is a reserved word.
    ',"system": {"title": "System"'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = ',"JcSystem": {"title": "System"'; # The "system" class is a reserved word.
    # V1 Issues
    '"basePath": "/api"'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = '"basePath": "/api/"'; # The extra slash at the end is needed to properly build the url.
    ',"/tags/{name}": {"parameters": [{"name": "name","in": "path","required": true,"type": "string"}],"delete": {"operationId": "tags_delete","summary": "Delete a Tag","tags": ["Tags"],"description": "Hidden as Tags is deprecated\n\nDelete a Tag.","parameters": [{"$ref": "#/parameters/trait:requestHeaders:Content-Type"},{"$ref": "#/parameters/trait:requestHeaders:Accept"}],"responses": {"200": {"description": "","schema": {"$ref": "#/definitions/tag"}}},"security": [{"x-api-key": []}]}}' = '' # Prevents PowerShell from parsing json. Within the "paths" section there is "/tags/{name}" and "/Tags/{name}" which causes a duplication error.
    '"type": "object","organization": {"type": "string","description": "The ID of the organization."}'                                                                                                                                                                                                                                                                                                                                                                                                        = '"type":"object"'; # This section is in the wrong place within the json.
    '"type": "null"'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = '"type":"string"'; # A type of null is not valid.
    '"type": ["null","integer"]'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = '"type":"integer"'; # A type of null is not valid.
    # V2 Issues
    '"basePath": "/api/v2"'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = '"basePath": "/api/v2/"'; # The extra slash at the end is needed to properly build the url.
    ',"": {"domain": "veniam"}'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               = ''; # Prevents PowerShell from parsing json. # Property name can not be blank.
    '["object","null"]'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = '"object"'; # A type of null is not valid.
    '["string","null"]'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = '"string"'; # A type of null is not valid.
    '["string","number","boolean","null"]'                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = '"string"'; # A type of null is not valid.
    '["string","number","boolean"]'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = '"string"'; # Error: Invalid type 'string,number,boolean' in schema
    '"jobId"'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 = '"id"'; # The transform removes the "-" in the parent objects name, "job-id", which makes the parent name the same as the child.
    # Custom Tweaks
    '"tags": ["Systemusers"]'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 = '"tags": ["SystemUsers"]'; # Change casing for pretty cmdlet names
    '{"$ref": "#/parameters/trait:requestHeaders:Content-Type"}'                                                                                                                                                                                                                                                                                                                                                                                                                                              = ''; # This will be passed in later through the Module.cs file.
    '{"$ref": "#/parameters/trait:requestHeaders:Accept"}'                                                                                                                                                                                                                                                                                                                                                                                                                                                    = ''; # This will be passed in later through the Module.cs file.
    '{"$ref": "#/parameters/trait:multiTenantRequestHeaders:x-org-id"}'                                                                                                                                                                                                                                                                                                                                                                                                                                       = ''; # Along with the ApiKey this will be passed in later through the Module.cs file.
    '{"name": "Content-Type","in": "header","type": "string"},'                                                                                                                                                                                                                                                                                                                                                                                                                                               = '';
    '{"name": "Accept","in": "header","type": "string"},'                                                                                                                                                                                                                                                                                                                                                                                                                                                     = '';
    '{"name": "x-org-id","in": "header","type": "string"}'                                                                                                                                                                                                                                                                                                                                                                                                                                                    = '';
    ',,'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = ',';
    '{,'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = '{';
    ',}'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = '}';
    '[,'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = '[';
    ',]'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = ']';
    ',"format": "ipv4"'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = ''; # Remove StopLight syntax
    # V1 OperationIds for friendlier cmdlet names
    'applications_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Create-Application';
    'applications_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'Delete-Application';
    'applications_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Get-Application';
    'applications_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-Application';
    'applications_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Put-Application';
    'application_templates_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-ApplicationTemplate';
    'application_templates_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'Get-ApplicationTemplate';
    'commands_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'Create-Command';
    'commands_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Delete-Command';
    'commands_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Get-Command';
    'commands_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-Command';
    'commands_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Put-Command';
    'command_file_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Get-CommandFile';
    'command_results_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'Delete-CommandResult';
    'command_results_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'Get-CommandResult';
    'command_results_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'List-CommandResult';
    'command_trigger_webhook_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Start-CommandTriggerWebhook';
    'organization_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-Organization';
    'search_organizations_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'Search-Organization';
    'radius_servers_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'Create-RadiusServer';
    'radius_servers_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-RadiusServer';
    'radius_servers_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'Put-RadiusServer';
    'sshkey_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Create-SshKey';
    'sshkey_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'Delete-SshKey';
    'sshkey_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-SshKey';
    'systems_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'Delete-System';
    'systems_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Get-System';
    'systems_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-System';
    'systems_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Put-System';
    'search_systems_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'Search-System';
    'systems_systemusers_binding_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-SystemSystemUserBinding';
    'systems_systemusers_binding_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Put-SystemSystemUserBinding';
    'systemusers_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Create-SystemUser';
    'systemusers_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'Delete-SystemUser';
    'systemusers_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Get-SystemUser';
    'systemusers_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-SystemUser';
    'systemusers_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Put-SystemUser';
    'search_systemusers_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 = 'Search-SystemUser';
    'systemusers_unlock'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'Unlock-SystemUser';
    'systemusers_resetmfa'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'Reset-SystemUserMfa';
    'systemusers_systems_binding_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-SystemUserSystemBinding';
    'systemusers_systems_binding_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Put-SystemUserSystemBinding';
    'tags_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'Create-Tag';
    'tags_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Delete-Tag';
    'tags_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'Get-Tag';
    'tags_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'List-Tag';
    'tags_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'Put-Tag';
    # V2 OperationIds for friendlier cmdlet names
    'applemdm_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'New-AppleMdm';
    'applemdm_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-AppleMdm';
    'applemdm_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Delete-AppleMdm';
    'applemdm_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Put-AppleMdm';
    'policyresults_org_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'List-OrgPolicyResults';
    'bulk_usersCreate'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Create-BulkUserJob';
    'bulk_usersCreateResults'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 = 'Get-BulkUserJobResult';
    'workdays_deauthorize'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'Remove-WorkdayAuthorization';
    'groups_system_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'Create-GroupSystem';
    'groups_user_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Create-GroupUser';
    'groups_system_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Get-GroupSystem';
    'groups_user_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Get-GroupUser';
    'workdays_authorize'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'Create-WorkdayAuthorization';
    'activedirectories_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'Create-ActiveDirectory';
    'activedirectories_agentsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Create-ActiveDirectoryAgent';
    'duo_accountPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Create-DuoAccount';
    'duo_applicationPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'Create-DuoApplication';
    'ldapservers_sambaDomainsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Create-LdapServerSambaDomain';
    'policies_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'Create-Policy';
    'providers_postAdmins'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'Create-ProviderAdmin';
    'translationRules_gSuitePost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Create-TranslationRuleGSuite';
    'translationRules_office365Post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'Create-TranslationRuleOffice365';
    'workdays_post'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'Create-Workday';
    'activedirectories_agentsDelete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'Delete-ActiveDirectoryAgent';
    'groups_system_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'Delete-GroupSystem';
    'groups_user_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'Delete-GroupUser';
    'ldapservers_sambaDomainsDelete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'Delete-LdapServerSambaDomain';
    'translationRules_gSuiteDelete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'Delete-TranslationRuleGSuite';
    'translationRules_office365Delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Delete-TranslationRuleOffice365';
    'activedirectories_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'Delete-ActiveDirectory';
    'policies_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Delete-Policy';
    'activedirectories_agentsGet'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Get-ActiveDirectoryAgent';
    'gsuites_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Get-GSuite';
    'ldapservers_sambaDomainsGet'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Get-LdapServerSambaDomain';
    'policytemplates_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'Get-PolicyTemplate';
    'systems_getFDEKey'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Get-SystemFDEKey';
    'translationRules_gSuiteGet'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'Get-TranslationRuleGSuite';
    'translationRules_office365Get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'Get-TranslationRuleOffice365';
    'workdays_settings'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Get-WorkdaySetting';
    'activedirectories_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = 'Get-ActiveDirectory';
    'policies_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Get-Policy';
    'workdays_importresults'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'Import-WorkdayResult';
    'jobs_results'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-JobResult';
    'workdays_workers'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-WorkdayWorker';
    'activedirectories_agentsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-ActiveDirectoryAgent';
    'groups_system_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-GroupSystem';
    'groups_user_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-GroupUser';
    'ldapservers_sambaDomainsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-LdapServerSambaDomain';
    'policytemplates_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'List-PolicyTemplate';
    'providers_listAdministrators'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-ProviderAdministrator';
    'translationRules_gSuiteList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-TranslationRuleGSuite';
    'translationRules_office365List'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'List-TranslationRuleOffice365';
    'activedirectories_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'List-ActiveDirectory';
    'directories_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-Directory';
    'graph_systemGroupMembersList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-GraphSystemGroupMembers';
    'graph_userGroupMembersList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-GraphUserGroupMembers';
    'policies_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-Policy';
    'systeminsights_list_apps'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'List-SysteminsightsApps';
    'systeminsights_list_bitlocker_info'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-SysteminsightsBitlockerInfo';
    'systeminsights_list_browser_plugins'                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-SysteminsightsBrowserPlugins';
    'systeminsights_list_chrome_extensions'                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = 'List-SysteminsightsChromeExtensions';
    'systeminsights_list_disk_encryption'                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-SysteminsightsDiskEncryption';
    'systeminsights_list_disk_info'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-SysteminsightsDiskInfo';
    'systeminsights_list_etc_hosts'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-SysteminsightsEtcHosts';
    'systeminsights_list_firefox_addons'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-SysteminsightsFirefoxAddons';
    'systeminsights_list_groups'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-SysteminsightsGroups';
    'systeminsights_list_interface_addresses'                                                                                                                                                                                                                                                                                                                                                                                                                                                                 = 'List-SysteminsightsInterfaceAddresses';
    'systeminsights_list_kernel_info'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'List-SysteminsightsKernelInfo';
    'systeminsights_list_logical_drives'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-SysteminsightsLogicalDrives';
    'systeminsights_list_mounts'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-SysteminsightsMounts';
    'systeminsights_list_os_version'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'List-SysteminsightsOsVersion';
    'systeminsights_list_patches'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-SysteminsightsPatches';
    'systeminsights_list_programs'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-SysteminsightsPrograms';
    'systeminsights_list_safari_extensions'                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = 'List-SysteminsightsSafariExtensions';
    'systeminsights_list_system_apps'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'List-SysteminsightsSystemGroups';
    'systeminsights_list_system_bitlocker_info'                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'List-SysteminsightsSystemSystemControls';
    'systeminsights_list_system_browser_plugins'                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-SysteminsightsSystemEtcHosts';
    'systeminsights_list_system_chrome_extensions'                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-SysteminsightsSystemApps';
    'systeminsights_list_system_controls'                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-SysteminsightsSystemControls';
    'systeminsights_list_system_disk_encryption'                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-SysteminsightsSystemInterfaceAddresses';
    'systeminsights_list_system_disk_info'                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'List-SysteminsightsSystemUsers';
    'systeminsights_list_system_etc_hosts'                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'List-SysteminsightsSystemBitlockerInfo';
    'systeminsights_list_system_firefox_addons'                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'List-SysteminsightsSystemFirefoxAddons';
    'systeminsights_list_system_groups'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-SysteminsightsSystemPatches';
    'systeminsights_list_system_info'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'List-SysteminsightsSystemInfo';
    'systeminsights_list_system_interface_addresses'                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'List-SysteminsightsSystemMounts';
    'systeminsights_list_system_kernel_info'                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'List-SysteminsightsSystemOsVersion';
    'systeminsights_list_system_logical_drives'                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'List-SysteminsightsSystemDiskEncryption';
    'systeminsights_list_system_mounts'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-SysteminsightsSystemChromeExtensions';
    'systeminsights_list_system_os_version'                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = 'List-SysteminsightsSystemLogicalDrives';
    'systeminsights_list_system_patches'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-SysteminsightsSystemDiskInfo';
    'systeminsights_list_system_programs'                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-SysteminsightsSystemKernelInfo';
    'systeminsights_list_system_safari_extensions'                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-SysteminsightsSystemBrowserPlugins';
    'systeminsights_list_system_system_controls'                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-SysteminsightsSystemSystemInfo';
    'systeminsights_list_system_system_info'                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'List-SysteminsightsSystemSafariExtensions';
    'systeminsights_list_system_uptime'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-SysteminsightsSystemUptime';
    'systeminsights_list_system_users'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-SysteminsightsSystemPrograms';
    'systeminsights_list_uptime'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-SysteminsightsUptime';
    'systeminsights_list_users'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'List-SysteminsightsUsers';
    'groups_system_patch'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'Patch-GroupSystem';
    'groups_user_patch'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Patch-GroupUser';
    'gsuites_patch'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'Patch-GSuite';
    'groups_system_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Put-GroupSystem';
    'groups_user_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Put-GroupUser';
    'ldapservers_sambaDomainsPut'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'Put-LdapServerSambaDomain';
    'policies_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Put-Policy';
    'users_sendEmails'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Send-UserEmail';
    'graph_activeDirectoryAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = 'Set-GraphActiveDirectoryAssociation';
    'graph_applicationAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Set-GraphApplicationAssociation';
    'graph_commandAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'Set-GraphCommandAssociation';
    'graph_gSuiteAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Set-GraphGSuiteAssociation';
    'graph_ldapServerAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Set-GraphLdapServerAssociation';
    'graph_office365AssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Set-GraphOffice365Association';
    'graph_policyAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Set-GraphPolicyAssociation';
    'graph_radiusServerAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'Set-GraphRadiusServerAssociation';
    'graph_systemAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Set-GraphSystemAssociation';
    'graph_systemGroupAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Set-GraphSystemGroupAssociation';
    'graph_systemGroupMembersPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Set-GraphSystemGroupMembers';
    'graph_userAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'Set-GraphUserAssociation';
    'graph_userGroupAssociationsPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Set-GraphUserGroupAssociation';
    'graph_userGroupMembersPost'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'Set-GraphUserGroupMembers';
    'bulk_usersUpdate'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'Update-BulkUsers';
    'workdays_delete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Delete-Workday';
    'duo_accountDelete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Delete-DuoAccount';
    'duo_applicationDelete'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = 'Delete-DuoApplication';
    'jobs_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'Get-Job';
    'ldapservers_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Get-LdapServer';
    'policyresults_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Get-PolicyResult';
    'workdays_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Get-Workday';
    'duo_accountGet'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'Get-DuoAccount';
    'duo_applicationGet'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'Get-DuoApplication';
    'org_crypto_get'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'Get-OrgCrypto';
    'workdays_import'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'Import-Workday';
    'graph_activeDirectoryTraverseUser'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-GraphActiveDirectoryTraverseUser';
    'graph_activeDirectoryTraverseUserGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'List-GraphActiveDirectoryTraverseUserGroup';
    'graph_applicationTraverseUser'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphApplicationTraverseUser';
    'graph_applicationTraverseUserGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-GraphApplicationTraverseUserGroup';
    'graph_commandTraverseSystem'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-GraphCommandTraverseSystem';
    'graph_commandTraverseSystemGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-GraphCommandTraverseSystemGroup';
    'graph_gSuiteTraverseUser'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'List-GraphGSuiteTraverseUser';
    'graph_gSuiteTraverseUserGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphGSuiteTraverseUserGroup';
    'graph_ldapServerTraverseUser'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-GraphLdapServerTraverseUser';
    'graph_ldapServerTraverseUserGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-GraphLdapServerTraverseUserGroup';
    'graph_office365TraverseUser'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-GraphOffice365TraverseUser';
    'graph_office365TraverseUserGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-GraphOffice365TraverseUserGroup';
    'graph_policyTraverseSystem'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-GraphPolicyTraverseSystem';
    'graph_policyTraverseSystemGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'List-GraphPolicyTraverseSystemGroup';
    'graph_radiusServerTraverseUser'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'List-GraphRadiusServerTraverseUser';
    'graph_radiusServerTraverseUserGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-GraphRadiusServerTraverseUserGroup';
    'graph_systemGroupMemberOf'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'List-GraphSystemGroupMemberOf';
    'graph_systemGroupMembership'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-GraphSystemGroupMembership';
    'graph_systemGroupTraverseCommand'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-GraphSystemGroupTraverseCommand';
    'graph_systemGroupTraversePolicy'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'List-GraphSystemGroupTraversePolicy';
    'graph_systemGroupTraverseUser'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphSystemGroupTraverseUser';
    'graph_systemGroupTraverseUserGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-GraphSystemGroupTraverseUserGroup';
    'graph_systemMemberOf'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    = 'List-GraphSystemMemberOf';
    'graph_systemTraverseCommand'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-GraphSystemTraverseCommand';
    'graph_systemTraversePolicy'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-GraphSystemTraversePolicy';
    'graph_systemTraverseUser'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'List-GraphSystemTraverseUser';
    'graph_systemTraverseUserGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphSystemTraverseUserGroup';
    'graph_userGroupMemberOf'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 = 'List-GraphUserGroupMemberOf';
    'graph_userGroupMembership'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               = 'List-GraphUserGroupMembership';
    'graph_userGroupTraverseActiveDirectory'                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = 'List-GraphUserGroupTraverseActiveDirectory';
    'graph_userGroupTraverseApplication'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-GraphUserGroupTraverseApplication';
    'graph_userGroupTraverseDirectory'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-GraphUserGroupTraverseDirectory';
    'graph_userGroupTraverseGSuite'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphUserGroupTraversegSuite';
    'graph_userGroupTraverseLdapServer'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-GraphUserGroupTraverseldapServer';
    'graph_userGroupTraverseOffice365'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-GraphUserGroupTraverseOffice365';
    'graph_userGroupTraverseRadiusServer'                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-GraphUserGroupTraverseRadiusServer';
    'graph_userGroupTraverseSystem'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphUserGroupTraverseSystem';
    'graph_userGroupTraverseSystemGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-GraphUserGroupTraverseSystemGroup';
    'graph_userMemberOf'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-GraphUserMemberOf';
    'graph_userTraverseActiveDirectory'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-GraphUserTraverseActiveDirectory';
    'graph_userTraverseApplication'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphUserTraverseApplication';
    'graph_userTraverseDirectory'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-GraphUserTraverseDirectory';
    'graph_userTraverseGSuite'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'List-GraphUserTraversegSuite';
    'graph_userTraverseLdapServer'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-GraphUserTraverseldapServer';
    'graph_userTraverseOffice365'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-GraphUserTraverseOffice365';
    'graph_userTraverseRadiusServer'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'List-GraphUserTraverseRadiusServer';
    'graph_userTraverseSystem'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                = 'List-GraphUserTraverseSystem';
    'graph_userTraverseSystemGroup'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphUserTraverseSystemGroup';
    'graph_activeDirectoryAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = 'List-GraphActiveDirectoryAssociation';
    'graph_applicationAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-GraphApplicationAssociation';
    'graph_commandAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-GraphCommandAssociation';
    'graph_gSuiteAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-GraphGSuiteAssociation';
    'graph_ldapServerAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-GraphLdapServerAssociation';
    'graph_office365AssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'List-GraphOffice365Association';
    'graph_policyAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-GraphPolicyAssociation';
    'graph_radiusServerAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-GraphRadiusServerAssociation';
    'graph_systemAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'List-GraphSystemAssociation';
    'graph_systemGroupAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'List-GraphSystemGroupAssociation';
    'graph_userAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              = 'List-GraphUserAssociation';
    'graph_userGroupAssociationsList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'List-GraphUserGroupAssociation';
    'groups_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             = 'List-Group';
    'ldapservers_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        = 'List-LdapServer';
    'policyresults_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      = 'List-PolicyResult';
    'policystatuses_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-PolicyStatus';
    'workdays_list'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           = 'List-Workday';
    'duo_accountList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 'List-DuoAccount';
    'duo_applicationList'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     = 'List-DuoApplication';
    'ldapservers_patch'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       = 'Patch-LdapServer';
    'workdays_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            = 'Put-Workday';
    'org_crypto_put'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          = 'Put-OrgCrypto';
    'duo_applicationUpdate'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   = 'Update-DuoApplication';
}
$ApiHash.GetEnumerator() | ForEach-Object {
    $OutputFileName = ($_.Name).Split('_')[1] + '.json'
    $OutputFullPath = $OutputFilePath + $OutputFileName
    $WebRequest = If ($_.Name -like 'Url_*')
    {
        (Invoke-WebRequest -Uri:($_.Value)).Content
    }
    Else
    {
        Get-Content -Path:($_.Value) -Raw
    }
    If ([System.String]::IsNullOrEmpty($WebRequest))
    {
        Write-Error ('No content was returned from: ' + $_.Value)
    }
    Else
    {
        # Prep json for find and replace by flattening string
        $ReadyForConvert = $WebRequest
        # Manipulate JSON
        $OperationIdMatches = Select-String -InputObject:($ReadyForConvert) -Pattern:([regex]'(?s)(?<=operationId": ")(.*?)(?=".*?$)') -AllMatches
        $OperationIdMatchesValues = $OperationIdMatches.Matches.Value
        ForEach ($OperationIdMatchesValue In $OperationIdMatchesValues)
        {
            If (-not $FindReplaceHash.Contains([System.String]$OperationIdMatchesValue))
            {
                Write-Warning ('Unknown ' + $_.Name + ' operationId: ' + $OperationIdMatchesValue + ';')
            }
        }
        While ($ReadyForConvert -match "`n ")
        {
            $ReadyForConvert = $ReadyForConvert.Replace("`n ", "`n")
        }
        $ReadyForConvert = $ReadyForConvert.Replace("`n", "")
        While ($ReadyForConvert -match "`r ")
        {
            $ReadyForConvert = $ReadyForConvert.Replace("`r ", "`r")
        }
        $ReadyForConvert = $ReadyForConvert.Replace("`r", "")
        # Transform file
        $FindReplaceHash.GetEnumerator() | ForEach-Object {
            $PatternMatch = $ReadyForConvert | Select-String -Pattern:([regex]::Escape($_.Name))
            If (-not [System.String]::IsNullOrEmpty($PatternMatch))
            {
                $ReadyForConvert = $ReadyForConvert.Replace([string]$_.Name, [string]$_.Value)
                $ReadyForConvert = $ReadyForConvert.Replace([string]$PatternMatch.Matches.Value, [string]$_.Value)
            }
        }
        # Convert json string to object
        $JsonExport = $ReadyForConvert | ConvertFrom-Json -Depth:(99);
        # Remove tag elements
        $JsonExport.paths = $JsonExport.paths | Select-Object * -ExcludeProperty:('/tags', '/Tag/{name}', '/Tags/{name}');
        # Export file
        # $WebRequest | Out-File -FilePath:($OutputFilePath + ($_.Name).Split('_')[1] + '_Org.json')
        # $ReadyForConvert | Out-File -FilePath:($OutputFilePath + ($_.Name).Split('_')[1] + '_ReadyForConvert.json')
        $NewSpec = $JsonExport | ConvertTo-Json -Depth:(99)
        If (Test-Path -Path:($OutputFullPath))
        {
            $CurrentSpec = Get-Content -Path:($OutputFullPath) -Raw
            $CurrentSpecCompare = [System.String]$CurrentSpec.Trim() -split "`r"
            $NewSpecCompare = [System.String]$NewSpec.Trim() -split "`r"
            $CompareResults = Compare-Object -ReferenceObject:($CurrentSpecCompare) -DifferenceObject:($NewSpecCompare)
            If (-not [System.String]::IsNullOrEmpty($CompareResults))
            {
                $NewSpec | Out-File -FilePath:($OutputFullPath)
                $UpdatedSpec = $true
            }
        }
    }
}

Write-Host ("##vso[task.setvariable variable=UpdatedSpec]$UpdatedSpec")
Return $UpdatedSpec